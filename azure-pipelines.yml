# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- none

pool:
  vmImage: 'ubuntu-latest'

variables:
  - name: NewAppName
    value: 'azureapp'
  - name: NewPort
    value: '9090'
  - name: PropertiesFilePath
    value: '$(System.DefaultWorkingDirectory)/src/main/resources/application.properties'

jobs:
- job: ReplaceProperties
  steps:
  - checkout: self

  - script: |
      sed -i 's/^spring.application.name=.*/spring.application.name=$(NewAppName)/' $(PropertiesFilePath)
      sed -i 's/^server.port=.*/server.port=$(NewPort)/' $(PropertiesFilePath)
    displayName: 'Replace values in application.properties'

  - task: PublishBuildArtifacts@1
    inputs:
      pathtoPublish: '$(Build.ArtifactStagingDirectory)/target'
      artifactName: 'App'
      publishLocation: 'container'
    displayName: 'Publish Artifact'

  # Add additional steps as needed for your deployment or other tasks
